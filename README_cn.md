PaddleSleeve
===


**PaddleSleeve是基于百度开源深度学习平台飞桨的安全与隐私工具**，为AI产业实践提供丰富、有效、易用的模型安全及隐私评测及保护能力。

PaddleSleeve作为一款贴近实践应用与现实风险的AI安全和隐私工具，具备以下特性：

- **丰富的AI应用场景**：支持多种现实AI任务，包含图像分类、目标识别等
- **现实的AI安全及隐私风险**：针对对抗样本、自然及环境干扰、模型推断、模型窃取等高危风险，提供全面的检测评估
- **支持产业级模型**：支持对ResNet、YOLO等产业级模型进行安全和隐私加固


## 主要功能

PaddleSleeve融合了业界最前沿的攻击方法与策略，用于评估模型的安全与隐私性能，并拥有全面、灵活的安全与隐私增强手段。其主要功能包括：

- **模型攻击与评估**
  - 鲁棒性（对抗场景）：集成最新的黑白盒对抗样本攻击算法，测试和评估模型在对抗场景下的鲁棒性。
  - 鲁棒性（非对抗场景）：使用光照、噪点、天气在内的多种拟自然扰动算法，测试和评估模型在非对抗场景下的鲁棒性。可以跨框架进行模型比较，如将用户的飞桨模型与pytorch、keras模型进行比较。
  - 隐私性：基于梯度泄露和生成对抗网络的侧信道逆向攻击，测试模型数据被还原的风险；基于影子模型的黑盒推断与重构攻击算法，测试模型是否存在关键信息泄露风险；支持AUC、Recall、结构相似度、峰值信噪比（Peak SNR）等隐私攻击效果评估指标。
- **模型防御**
  - 对抗训练：支持新训练、模型精调等方式进行对抗训练，支持多个业界前沿、性能良好的对抗训练方法，如TRADES、AWP等。
  - 图像重建/噪声过滤：提供多种对抗噪声过滤算法，实现非侵入式的对抗鲁棒性增强，无需修改模型。
  - 隐私增强优化器：提供基于差分隐私扰动、梯度压缩等方法的一系列隐私增强优化器（如SGD、Adam、Momentum等），可便捷地训练出有效抵御常见隐私窃取攻击的模型。


## 技术特色

- **融合业界前沿的AI安全与隐私攻击技术：**
  - 集成多个业界前沿的对抗攻击算法、自研的拟自然扰动算法，利用自动化攻击策略，有效测试模型在对抗及非对抗场景下的鲁棒性。
  - 集成多个业界前沿的模型数据推断、数据逆向、参数窃取算法，有效测试模型在私有化部署、对外服务、联合训练等场景下的隐私泄露风险。
- **全面、灵活、易用的安全与隐私增强手段：**
  - 嵌入飞桨训练阶段的安全与隐私增强手段：包括多个业界前沿的对抗训练算法、隐私增强优化器等，安全和隐私性能提升明显。
  - 非侵入式安全与私增强手段：包括去噪、特征压缩、图像恢复、模糊化等方法，易于使用，可直接用于已有模型或飞桨预训练模型，无需重训练即可提升模型安全和隐私等级。


## 对抗样本生成与防御 AdvBox 

近年来，深度学习技术发展迅速，尤其是在计算机视觉领域内，深度学习有了越来越多的落地场景和应用场景。

对抗样本攻击（Adversarial Example Attack）可以在正常数据输入的基础上精心构造足够小的扰动，在肉眼几乎无法察觉的情况下，导致AI模型识别错误。一些如对抗贴图（Adversarial Patch）的对抗样本形式，干扰图像明显，但不影响人类的识别。目前除了图像分类，人脸识别、目标识别、 图像分割、语音识别、语义理解等各种任务都可能受到对抗样本的干扰。

Advbox收集整理了各种对抗样本的生成方法及模型加固方法，便于Paddle的开发者、使用者能更好地发现和降低模型健壮性的风险敞口。Advbox支持各种对抗样本生成的经典算法，如FGSM，BIM，JSMA和C/W等方法。

目前对抗训练是提升模型鲁棒性的主要方法，需要在训练过程中加入对抗样本到正常样本中，Advbox有相关对抗训练的示例。

## 鲁棒性评测 Robustness

业界常把ML模型抵抗输入干扰并给出正确判断的能力称为鲁棒性。一般而言，AI模型的安全分为两类：现实环境的干扰对模型可靠性（Safety）的影响，如光线明暗、“雨雪风霜”等；另一种是在人为构造的恶意攻击情况下对安全性（Security）的影响，如对抗样本。从干扰成功的难易角度上讲，定向比非定向攻击更难，黑盒比白盒攻击更难。

模型鲁棒性有三种应用场景：一般应用场景、如内容审核的强对抗场景、自动驾驶等安全攸关（safety-critical）场景。在安全攸关场景中，一些干扰的出现是极端环境的小概率事件，在数据集占比极小，甚至可能都不会存在 ，例如翻车后的车底图片、强光照耀等。由于模型未经过此类数据的训练，在强调安全的场景下其鲁棒性会受到质疑。

Robustness模块主要基于现实意义对模型鲁棒性进行评估。对图像进行的变换主要有：空间变换、色彩、明暗、天气等，模拟真实世界的失真、变形、噪点。

## 版权和许可证
PaddleSleeve由[Apache-2.0 license](LICENSE)提供
